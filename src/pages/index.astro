---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout>
  <div class="parent">
    <!-- Logo and Text Block -->
    <div class="div2">
      <div class="logo-container">
        <img src="/assets/icons/ig-logo.svg" alt="Company Logo" class="logo-image" />
      </div>
      <div class="text-container">
        <div class="text-block">
          <h2>IANA GLUSHACH</h2>
          <hr class="separator-line" />
          <p class="b-c-text">Bonsai and Ceramics</p>
        </div>
      </div>
    </div>

    <!-- "We Are Coming Soon" -->
    <div class="div6">
      <h2>Our new website is on its way! </h2>
    </div>

    <!-- Tagline -->
    <div class="div7">
      <p class="tagline">We’re putting the final touches in place, and we can’t wait to share it with you.<br>
      In the meantime, visit our <a href="https://www.etsy.com/shop/IGBonsaiCeramics" class="etsy-store-link">Etsy Store.</a>
      </p>
    </div>

    <!-- Visit Etsy Store link -->
    <div class="div7">
      <p class="tagline">Want updates? Enter your email below!</p>
    </div>

    <!-- Subscription form -->
    <div class="div8">
      <form id="subscribeForm" action="/api/subscribe" method="POST" class="subscribe-form">
        <input type="email" name="email" placeholder="Enter your e-mail" aria-label="Email Input" required />
        <button type="submit" class="g-recaptcha" data-sitekey="YOUR_SITE_KEY" data-callback="onReCaptchaSuccess" data-size="invisible" aria-label="Notify me when launched">
          Notify Me
        </button>
        <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response" />
      </form>

      <!-- Success message, hidden by default -->
      <div id="successMessage" class="success-message" style="display: none;">
        <h2>Thank you for subscribing!</h2>
        <p>We will notify you when our website launches.</p>
      </div>

      <!-- Error message, hidden by default -->
      <div id="errorMessage" class="error-message" style="display: none;">
        <h2>An error occurred!</h2>
        <p>Please try again later.</p>
      </div>
    </div>

    <!-- Follow us section -->
    <div class="div9">
      <h3>Follow us on</h3>
    </div>
    <div class="div10">
      <div class="social-icons">
        <a href="https://www.instagram.com/ig_bonsai_ceramics/" target="_blank" aria-label="Instagram">
          <img src="/assets/icons/insta.png" alt="Instagram" />
        </a>
        <a href="https://www.facebook.com/IGbonsaiCeramics/" target="_blank" aria-label="Facebook">
          <img src="/assets/icons/facebook.png" alt="Facebook" />
        </a>
      </div>
    </div>

    <!-- Footer -->
    <div class="div13">
      <footer>
        2024 &copy; Iana Glushach Bonsai and Ceramics - All Rights Reserved
      </footer>
    </div>
  </div>

  <!-- Include Google reCAPTCHA -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <!-- Include Orest Bida's CookieConsent CSS and JavaScript from CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"></script>

  <!-- Initialize Orest Bida's CookieConsent -->
  <script>
    window.addEventListener("load", function () {
      const cc = initCookieConsent();
      cc.run({
        current_lang: "en",
        autoclear_cookies: true,
        theme_css: "", // Custom CSS (leave empty for default)
        languages: {
          en: {
            consent_modal: {
              title: "We use cookies!",
              description: 'This website uses cookies to ensure you get the best experience. <button type="button" data-cc="c-settings">Let me choose</button>',
              primary_btn: {
                text: "Accept all",
                role: "accept_all"
              },
              secondary_btn: {
                text: "Reject all",
                role: "accept_necessary"
              }
            },
            settings_modal: {
              title: "Cookie preferences",
              save_settings_btn: "Save settings",
              accept_all_btn: "Accept all",
              reject_all_btn: "Reject all",
              close_btn_label: "Close",
              blocks: [
                {
                  title: "Necessary cookies",
                  description: "These cookies are essential for the website to function correctly.",
                  toggle: { value: "necessary", enabled: true, readonly: true }
                },
                {
                  title: "Analytics cookies",
                  description: "These cookies help us understand how visitors interact with our website.",
                  toggle: { value: "analytics", enabled: false, readonly: false }
                },
                {
                  title: "Marketing cookies",
                  description: "These cookies are used for marketing purposes.",
                  toggle: { value: "marketing", enabled: false, readonly: false }
                }
              ]
            }
          }
        }
      });
    });

    // Trigger reCAPTCHA when form is submitted
    document.getElementById('subscribeForm').addEventListener('submit', function(event) {
      event.preventDefault();
      grecaptcha.execute(); // Trigger invisible reCAPTCHA
    });

    // Function called upon successful reCAPTCHA verification
    function onReCaptchaSuccess(token) {
      const form = document.getElementById('subscribeForm');
      const formData = new FormData(form);
      formData.append('g-recaptcha-response', token);

      // Hide form and show success message
      document.getElementById('subscribeForm').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';

      // Send data to server
      fetch(form.action, {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Server error');
        }
        return response.text();
      })
      .then(() => {
        // No further action needed, success message already shown
      })
      .catch((error) => {
        // Show error message
        document.getElementById('subscribeForm').style.display = 'block';
        document.getElementById('successMessage').style.display = 'none';
        document.getElementById('errorMessage').style.display = 'block';
        console.error('Error:', error.message);
      });
    }
  </script>
</BaseLayout>
